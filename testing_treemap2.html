<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>USA Treemap</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <style>
    body { font-family: sans-serif; }
    .node rect {
      stroke: #fff;
    }
    .label {
      pointer-events: none;
      font-size: 12px;
      fill: white;
      text-shadow: 1px 1px 2px black;
    }
    .state-label {
      font-size: 16px;
      font-weight: bold;
      fill: black;
    }
  </style>
</head>
<body>

<svg width="1000" height="600"></svg>

<script>
d3.json("https://raw.githubusercontent.com/tekkyboy/DSCI-550_Haunted-Places-of-America/main/DSCI-550_Visualizations_JSON/treemap_data_sorted.json")
  .then(function(data) {
    const width = 1000, height = 600;
    const svg = d3.select("svg");

    const color = d3.scaleOrdinal(d3.schemeCategory10);

    const root = d3.hierarchy(data)
      .sum(d => d.value)
      .sort((a, b) => b.value - a.value);

    d3.treemap()
      .size([width, height])
      .paddingInner(1)
      .paddingTop(d => d.depth === 1 ? 20 : 0)(root);

    const node = svg.selectAll("g")
      .data(root.descendants())
      .join("g")
      .attr("transform", d => `translate(${d.x0},${d.y0})`);

    node.append("rect")
      .attr("width", d => d.x1 - d.x0)
      .attr("height", d => d.y1 - d.y0)
      .attr("fill", d => {
        if (d.depth === 1) return color(d.data.name);
        if (d.parent) return color(d.parent.data.name);
        return "#ccc";
      });

    node.filter(d => !d.children).append("text")
      .attr("class", "label")
      .attr("x", 4)
      .attr("y", 14)
      .text(d => `${d.data.name} (${d.data.value})`);

    node.filter(d => d.depth === 1).append("text")
      .attr("class", "state-label")
      .attr("x", 4)
      .attr("y", 16)
      .text(d => d.data.name);
  });


</script>
</body>
</html>
